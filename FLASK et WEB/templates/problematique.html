{% extends 'header_layout.html' %}
{%block css%}<link rel="stylesheet" href="../static/QuestionSolution.css">{%endblock%}

{% block header %}

    <h1>{{prob[2]}}</h1>
    {% for i in range(0,len_question-1) %}
    <div class="tablo-question-solution">
        <button id="'q'+'{{choosen_question[i][0]}}'" class="question-button" onclick="show_hide('q'+'{{choosen_question[i][0]}}','s'+'{{choosen_solution[i][0]}}')">{{choosen_question[i][2]}}</button>
        <button id="'s'+'{{choosen_solution[i][0]}}'" class="solution-button" onclick="show_hide('s'+'{{choosen_solution[i][0]}}','q'+'{{choosen_question[i][0]}}')">{{choosen_solution[i][2]}}</button>
    </div>
    <!--à voir si la fin du for marche-->
    <div id="'-q'+'{{choosen_question[i][0]}}'" class="tablo-gagnants-perdants">
        <!--Le probleme de faire tout dans un tableau est ici. Pour un rang i de question et de solution, la solution gagnante et la question gagnante n'ont pas le rang i dans choosen_solution-->
        {%for j in every_question[i]%}
            {% if j==choosen_question[i] %}
                <p class="choix-gagnant">{{j}}</p> 
            {% else %}
                <p class="choix-perdant">{{j}}</p>
            {% endif %}
        {%endfor%}
    </div>
    
    <div id="'-s'+'{{choosen_solution[i][0]}}'" class="tablo-gagnants-perdants">
        {%for j in every_solution[i]%}
            {% if j==choosen_solution[i] %}
                <p class="choix-gagnant">{{j}}</p> 
            {% else %}
                <p class="choix-perdant">{{j}}</p>
            {% endif %}
        {%endfor%}
    </div>
    {% endfor %}

    
    <script>
        function show_hide(button_id,other_button_id) //cette fonction change le display css du bouton cliqué de grid à none (ça affiche ou non), si un autre grid est deja affiché elle le desactive au passage.
        {
            var Btn = document.getElementById("-"+button_id);
            var OtherBtn = document.getElementById("-"+other_button_id);
            if(Btn.style.display === "grid")
                {
                    Btn.style.display = "none";
                }
            else
                {
                    if(OtherBtn.style.display === "grid")
                    {
                        OtherBtn.style.display = "none";
                        Btn.style.display = "grid";
                    }
                    else
                    {
                        Btn.style.display = "grid";
                    }
                    
                }
        }
    </script>
  

    <div class="tablo-question-solution">
        <button class="question-button-only">{{last_question[2]}}</button> <!--il faut un moyen de savoir si on est dans un cas : vote de question ou vote de solution-->
    </div>

    <h2>{{message_vote}}</h2>

    {% if session.mail %}
    <div class="tablo-choix">
        {% for j in possible_solutions %}
            {% if j[0]==voted_solutions %}
                <a class="choisi" href="/problematique/{{prob[0]}}?id={{j[0]}}">{{j[2]}}</a>
            {% else %}
                <a class="choix" href="/problematique/{{prob[0]}}?id={{j[0]}}">{{j[2]}}</a>
            {% endif %}
        {%endfor%}
        <a class="choix" href="/problematique/ajout_prop/{{prob[0]}}/{{last_question[0]}}">+</a>
    </div>
        <a href="/problematique/{{prob[0]}}?cloture=True"><br />Cloture des votes (expérimental)</a>

    {%else %}
        <div class="tablo-choix">
            {% for j in possible_solutions%}
                <a class="choix">{{j[2]}}</a>
            {%endfor%}
        </div>

        <h2>Connecte-toi pour ajouter des solutions, envoyer des messages ou voter</h2>
    {% endif %}

    {% for m in messages %}
        <p>{{m}}</p>
    {% endfor %}
    {% if session.mail %}
    <p class="envoie message">
        <form class="form_new_msg" method ="POST">
            <input autocomplete="off" autofocus name="message" placeholder="Message a envoyé" type="text">
            <input type="submit" value="Envoyer">
        </form>
    </p>
    {% endif %}

{% endblock %}
